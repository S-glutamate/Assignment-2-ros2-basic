## launch文件综述
### 1. 背景
要实现机器人复杂的操控，我们不可能只有一个包，一个节点。难道我们每次启动的时候都要一个一个节点的启动吗？(所有系统全部启动，启动，启动!还有这个!),这无疑是很麻烦的，那有没有什么方法可以一下子全部启动呢，这便到了launch文件大展身手的时候了。
### 2. 介绍
Launch 文件是一种配置文件，主要用于简化多个节点或进程的启动流程、统一参数管理以及标准化环境配置。
### 3. 使用
在一些ROS2项目中你会看到launch.py文件，显然，由后缀可知launch文件需要符合python的语法。具体使用方法将在示例中介绍。除此之外launch文件还支持XMl，YAMl语言编写，但一般我们采用python。
### 4. launch文件示例
```bash
# 导入必要的模块
from launch import LaunchDescription
from launch_ros.actions import Node

# 这个方法是launch文件的主入口，在里面配置启动节点相关内容，这个名字是规定的不能改变
def generate_launch_description():
# Node表示节点，package为包名，namespace为命名空间，excutable为可执行文件名(与setup.py里面的名字相对应)，name为我们设置的名称
    return LaunchDescription([
        Node(
            package = 'turtlesim',
            namespace = 'turtlesim',
            exutable = 'turtlesim_node',
            name = 'sim'
        ),
        Node(
            package = 'turtlesim',
            namespace = 'turtlesim2',
            exutable = 'turtlesim_node',
            name = 'sim'
        ),
# 关系映射节点，映射输入和输出(可以简单理解为换一个名字)
        Node(
            package = 'turtlesim',
            namespace = 'mimic',
            remappings = [
                ('/input/pose','/turtlesim1/turtle1/pose'),
                ('/output/cmd_vel','/turtlesim2/turtle1/cmd_vel')
            ]
        )
    ])
```
```bash
# 接下来试着启动这个launch文件
# 先找一个功能包，建一个launch目录，在目录里新建一个launch.py文件，输入代码
# 打开命令行，编译，设置环境，运行文件
colcon build 
source install/setup.bash
# 推荐
ros2 launch 包名 launch文件名
# 不推荐 
ros2 launch launch文件的绝对路径
```
运行成功你会看到两个都有小乌龟的界面
```bash
# 通过命令行发布运动话题
ros2 topic pub -r 1 /turtlesiml/turtlel/cmd vel geometry msgs/msg/Twist "{linear:{x:2.0,y:0.0，z:0.0}，angular:{x:0.0，y:0.0，z:-1.8}}"publisher: beginning loop
```
如果顺利你将会看到两个绕圈运动的乌龟

思考一下为什么发布一个话题会使两个乌龟一起运动
### 5. launch文件进阶
如果我的项目是由多个功能包构成的每个功能包里都含有launch文件，或者我要使用他人已经封装好的项目，此时一个一个地启动launch文件也是很麻烦的；如果我要更改参数配置文件，我需要找到源代码读取参数配置文件的部分更改再构建，对于较大的功能包重新构建非常消耗时间，这会影响我们的工作效率；如果我要使用不同模式的算法用命令切换是最简单的——这便是launch文件启动其他launch文件的功能，以及参数配置功能。
#### 1. 在一个launch文件中启动其他launch文件
```bash
# 使用IncludeLaunchDescription来启动子launch文件
# IncludeLaunchDescription包含子launch文件
# PythonLaunchDescriptionSource一个类指定要包含的子launch文件来源
# PathJoinSubstitution是一个路径构造器，用于动态地构建文件路径。它接受一个路径片段列表作为参数，并将这些片段组合成一个完整的路径，当然你也可以使用绝对路径但这会导致项目可移植性降低。
# 使用FindPackageShare可以动态地找到包的路径，这样你的launch文件可以在不同的环境中运行，而不需要硬编码路径。
# 'my_package'包的名字，'launch','sub_launch.py'指的是功能包launch目录下的launch文件
# launch_arguments是传递参数给子launch文件
def generate_launch_description():
    return LaunchDescription([
        IncludeLaunchDescription(
            PythonLaunchDescriptionSource([
                PathJoinSubstitution([
                    FindPackageShare('my_package'), 
                    'launch',
                    'sub_launch.py'  
                ])，
            launch_arguments={
                'param1': 'value1',
                'param2': 'value2'
            }
            ])
        )
    ])
# 除了使用PathJoinSubstistution我们还可以使用os.path.join、get_package_share_directory和FindPackageShare来获取文件路径
package_path = FindPackageShare('my_package').perform(None)
launch_file_path = os.path.join(package_path, 'launch', 'sub_launch.py')

package_path = get_package_share_directory('my_package')
launch_file_path = os.path.join(package_path, 'launch', 'sub_launch.py')
```
#### 2. 参数(arguments和parameters)
##### 1. arguments
```bash
# arguments用于传递命令行参数给节点的可执行文件，这些参数通常用于控制可执行文件的行为，而不是配置节点内部的状态或行为。作用于launch文件
# DeclareLaunchArgument声明启动参数，包括参数名称，参数值和参数描述
def generate_launch_description():
    return LaunchDescription([
        DeclareLaunchArgument(
            'sensor_rate',
            default_value='10',
            description='Sampling rate of the sensor'
        ),
    ])
# 当我们声明启动参数之后，我们就可以在创建节点(指上文的Node)的时候用LaunchConfiguration来配置参数了，只需要加上下面这行命令
arguments=[{'sensor_rate'： LaunchConfiguration('sensor_rate')}]
# 然后我们就能在命令行里传递这个参数了如
ros2 launch my_package my_launch.py sensor_rate:=20
```
##### 2. parameters
```bash
#parameters属性用于传递节点在运行时需要的配置参数。这些参数通常是静态的，并且在节点启动时被读取一次，用于配置节点的行为。作用于节点。
parameters=[
    {'sensor_rate': 10},
    {'log_level': 'info'}]
# 如果是使用yaml文件配置则为
parameters=[params_file]
```
#### 3. 总结
用一个例子说明两者的区别：当我们使用ROS2 launch my_package my_launch.py argument：= ......时我们是指定了一个arguments，这个arguments它作用于launch文件选择对应的parameters。